angular.module("goApp",["ui.router","ngAnimate","angular-stripe"]).config(["$stateProvider","$urlRouterProvider","stripeProvider",function(e,t,r){r.setPublishableKey("pk_test_Y8LhLNUJyD0m1Zthhv3Q1ijz"),t.otherwise("/"),e.state("home",{templateUrl:"./views/home.html",controller:"homeCtrl",url:"/"}).state("loggin",{templateUrl:"./views/loggin.html",controller:"logginCtrl",url:"/loggin"}).state("cameras",{templateUrl:"./views/cameras.html",controller:"camerasCtrl",url:"/cameras"}).state("drones",{templateUrl:"./views/drones.html",controller:"dronesCtrl",url:"/drones"}).state("apparel",{templateUrl:"./views/apparel.html",controller:"apparelCtrl",url:"/apparel",resolve:{products:["mainService",function(e){return e.getItems().then(function(e){return e})}]}}).state("apparelProduct",{templateUrl:"./views/apparelProduct.html",controller:"apparelProductCtrl",url:"/apparel/:id/:gender"}).state("cart",{templateUrl:"./views/cart.html",controller:"cartCtrl",url:"/cart"}).state("checkout",{templateUrl:"./views/checkout.html",controller:"checkoutCtrl",url:"/checkout"})}]),angular.module("goApp").controller("apparelCtrl",["$scope","mainService","products",function(e,t,r){e.products=r,console.log(r),e.gender="Male",e.productFilter=function(t){return(t.gender===e.gender||"NULL"===t.gender)&&t}}]),angular.module("goApp").controller("camerasCtrl",["$scope",function(e){e.test="Cameras CTRL works",e.currentState="cameras"}]),angular.module("goApp").controller("apparelProductCtrl",["$scope","apparelProductService","$stateParams",function(e,t,r){var o=r.id,n=r.gender;console.log(o+" "+n),e.getProduct=function(){t.getProduct(r.id,r.gender).then(function(t){e.product=t[0],console.log(e.product)})}()}]),angular.module("goApp").service("apparelProductService",["$http",function(e){this.getProduct=function(t,r){return e({method:"GET",url:"/api/getProduct/"+t+"/"+r}).then(function(e){return e.data})}}]),angular.module("goApp").controller("cartCtrl",["$scope","cartService",function(e,t){e.values=[1,2,3,4,5,6,7,8,9,10]}]),angular.module("goApp").service("cartService",function(){}),angular.module("goApp").controller("checkoutCtrl",["$scope","checkoutService","stripe","$state",function(e,t,r,o){e.stepOneFinished=!1,e.stepTwoFinished=!1,e.stepTwoActive=!1,e.deliveryAddress={},e.billingAddress={},e.payment={},e.clearStepOne=function(t){e.stepOneFinished=!0;for(var r=document.getElementById("delivery_address"),o=document.getElementById("shipping_address"),n=0;n<r.length;n++)e.deliveryAddress[r.elements[n].name]=r.elements[n].value;if(t===!0){for(var n=0;n<r.length;n++)o[n].value=r[n].value;return void e.clearStepTwo()}e.stepTwoActive=!0},e.clearStepTwo=function(){e.stepTwoFinished=!0;for(var t=document.getElementById("shipping_address"),r=0;r<t.length;r++)e.billingAddress[t.elements[r].name]=t.elements[r].value;e.stepTwoActive=!1},e.editOne=function(){e.stepOneFinished=!1,e.stepTwoFinished=!1,e.stepTwoActive=!1},e.editTwo=function(){e.stepOneFinished=!0,e.stepTwoFinished=!1,e.stepTwoActive=!0},e.payment={},e.charge=function(){return r.card.createToken(e.payment.card).then(function(r){var o=angular.copy(e.payment);o.card=void 0,o.token=r.id,t.processPayment(100*e.total,o)}).then(function(t){swal({title:"Thank You!",text:"Your order will be shipped within 3 business days.",imageUrl:"http://www.sv411.com/wp-content/uploads/GoPro-Logo.jpg",confirmButtonText:"Continue exporing GoBro"}),e.zeroOut(),o.go("home")}).catch(function(e){e.type&&/^Stripe/.test(e.type)?console.log("Stripe error: ",e.message):console.log("Other error occurred, possibly with your API",e.message)})}}]),angular.module("goApp").service("checkoutService",["$http",function(e){this.processPayment=function(t,r){return e({method:"POST",url:"/api/payment",data:{amount:t,payment:r}})}}]),angular.module("goApp").controller("homeCtrl",["$scope",function(e){e.test="Home CTRL works",e.currentState="home",e.showVid=!1}]),angular.module("goApp").service("authService",["$http",function(e){this.login=function(t){return e({method:"POST",url:"/api/login",data:t}).then(function(e){return e})},this.logout=function(){return e({method:"GET",url:"/api/logout"}).then(function(e){return e})},this.getCurrentUser=function(){return e({method:"GET",url:"/api/me"}).then(function(e){return e})},this.registerUser=function(t){return console.log("authService",t),e({method:"POST",url:"/api/register",data:t}).then(function(e){return e})},this.editUser=function(t,r){return e({method:"PUT",url:"/api/user/"+t,data:r}).then(function(e){return e})}}]),angular.module("goApp").service("localStorageServ",["$http",function(e){this.store=function(e,t){return localStorage.setItem(e,JSON.stringify(t)),"saved"},this.get=function(e){var t=localStorage.getItem(e);return JSON.parse(t)}}]),angular.module("goApp").controller("logginCtrl",["$scope","authService","$state",function(e,t,r){e.test="Loggin CTRL works",e.login=function(o){console.log("stephen"),t.login(o).then(function(t){t.data?r.go("profile"):(alert("User does not exist"),e.user.password="")}).catch(function(e){alert("Unable to login")})},e.register=function(r){t.registerUser(r).then(function(t){console.log("loginCtrl",r),t.data?(alert("User Created"),e.newUser={}):alert("Unable to create user1")}).catch(function(e){alert("Unable to create user2")})}}]),angular.module("goApp").service("userService",["$http",function(e){this.getUsers=function(){return e({method:"GET",url:"/user"}).then(function(e){return e})},this.getUser=function(t){return e({method:"GET",url:"/user?_id="+t}).then(function(e){return e})}}]),angular.module("goApp").controller("dronesCtrl",["$scope",function(e){e.test="drones CTRL works"}]),angular.module("goApp").directive("banner",function(){return{restrict:"E",templateUrl:"./views/bannerDir.html",scope:{state:"=",products:"=",subtot:"=",incart:"="},controller:["$scope",function(e){e.hoverShop=!1,e.hoverWatch=!1,e.cartShow=!1}]}}),angular.module("goApp").directive("footer",function(){return{restrict:"E",templateUrl:"./views/footerDir.html",scope:{item:"="},controller:["$scope",function(e){}]}}),angular.module("goApp").controller("mainCtrl",["$scope","$state","$timeout","$rootScope","mainService",function(e,t,r,o,n){e.stateName,e.cart=[],e.subTotal=0,e.items=0,e.shipping=18,e.total=18,e.zeroOut=function(){e.cart=[],e.subTotal=0,e.items=0,e.total=0},e.addToCart=function(t,r,o){n.getItem(t,r,o).then(function(t){e.cart=n.checkDouble(e.cart,t),console.log(e.cart),e.subTotal=n.getSubTotal(e.cart),e.items=n.getNumOfItems(e.cart),e.total=parseInt(e.shipping)+parseInt(e.subTotal)})},e.removeFromCart=function(t){e.cart=n.removeItem(e.cart,t),e.subTotal=n.getSubTotal(e.cart),e.items=n.getNumOfItems(e.cart),e.total=parseInt(e.shipping)+parseInt(e.subTotal)},e.updateTotal=function(){e.subTotal=n.getSubTotal(e.cart),e.items=n.getNumOfItems(e.cart),e.total=parseInt(e.shipping)+parseInt(e.subTotal)},o.$on("$stateChangeStart",function(o,n,a,l,i){r(function(){e.stateName=t.current.name},100)})}]),angular.module("goApp").service("mainService",["$http",function(e){this.getItem=function(t,r,o){return e({method:"GET",url:"/api/getItem/"+t}).then(function(e){return e.data[0].count=r,"null"!==o&&(e.data[0].size=o),e.data[0]})},this.checkDouble=function(e,t){for(var r=0;r<e.length;r++)if(e[r].id===t.id)return e[r].count++,e;return e.push(t),e},this.getSubTotal=function(e){for(var t=0,r=0;r<e.length;r++)t+=parseFloat(e[r].count)*parseFloat(e[r].price);return t},this.getNumOfItems=function(e){for(var t=0,r=0;r<e.length;r++)t+=parseInt(e[r].count);return t},this.removeItem=function(e,t){for(var r=0;r<e.length;r++)if(e[r].id===t)return e.splice(r,1),e},this.getItems=function(){return e({method:"GET",url:"/api/getItems"}).then(function(e){return e.data})}}]);